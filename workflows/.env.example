# ========================================
# A4C Workflows - Environment Configuration
# ========================================
# Copy this file to .env.local and customize for your environment
# Last Updated: 2025-11-02
# ========================================

# ========================================
# WORKFLOW MODE (Primary Configuration)
# ========================================
# This is the PRIMARY variable that controls default behavior for ALL services.
# Most developers only need to set this one variable.
#
# Options: mock | development | production
#
# ┌─────────────┬──────────────┬──────────────┬─────────────────────────────┐
# │ Mode        │ DNS Provider │ Email        │ Use Case                    │
# ├─────────────┼──────────────┼──────────────┼─────────────────────────────┤
# │ mock        │ MockDNS      │ MockEmail    │ Unit tests, CI/CD           │
# │ development │ LoggingDNS   │ LoggingEmail │ Local dev (console logs)    │
# │ production  │ Cloudflare   │ Resend       │ Integration testing, prod   │
# └─────────────┴──────────────┴──────────────┴─────────────────────────────┘
#
# mock:
#   - All providers mocked (in-memory, no output)
#   - No network calls, works offline
#   - Fast test execution
#   - Use for: Unit tests, CI/CD pipelines
#
# development:
#   - All providers log to console (no real API calls)
#   - See DNS records that would be created
#   - See email content that would be sent
#   - Use for: Local development, debugging workflow logic
#
# production:
#   - All providers use real APIs
#   - Creates real DNS records
#   - Sends real emails
#   - Use for: Integration testing, staging, production deployment
#
WORKFLOW_MODE=development

# ========================================
# PROVIDER OVERRIDES (Advanced/Optional)
# ========================================
# ⚠️  ONLY uncomment these if you need to override the defaults from WORKFLOW_MODE
# ⚠️  Most developers should leave these commented and rely on WORKFLOW_MODE
#
# Common Override Scenarios:
#
# Scenario 1: Test DNS without sending emails
#   WORKFLOW_MODE=development
#   DNS_PROVIDER=cloudflare        # ← Override to real DNS
#   # EMAIL_PROVIDER=logging        # ← Use default (logging)
#
# Scenario 2: Test emails without creating DNS
#   WORKFLOW_MODE=development
#   # DNS_PROVIDER=logging          # ← Use default (logging)
#   EMAIL_PROVIDER=resend           # ← Override to real email
#
# Scenario 3: Full mock for fast iteration
#   WORKFLOW_MODE=mock
#   # DNS_PROVIDER=mock             # ← Use default (mock)
#   # EMAIL_PROVIDER=mock           # ← Use default (mock)
#
# DNS Provider Options: cloudflare | mock | logging | auto
# DNS_PROVIDER=cloudflare
#
# Email Provider Options: resend | smtp | mock | logging | auto
# EMAIL_PROVIDER=resend

# ========================================
# VALID CONFIGURATION COMBINATIONS
# ========================================
# ✅ VALID: WORKFLOW_MODE=development (no overrides)
#    Result: LoggingDNS + LoggingEmail (console output only)
#
# ✅ VALID: WORKFLOW_MODE=development, DNS_PROVIDER=cloudflare
#    Result: Real DNS + LoggingEmail (test DNS creation)
#
# ✅ VALID: WORKFLOW_MODE=production
#    Result: Cloudflare + Resend (requires credentials below)
#
# ✅ VALID: WORKFLOW_MODE=production, EMAIL_PROVIDER=mock
#    Result: Cloudflare + MockEmail (test DNS without emails)
#
# ❌ INVALID: WORKFLOW_MODE=production (no credentials)
#    Error: Missing CLOUDFLARE_API_TOKEN and RESEND_API_KEY
#
# ❌ INVALID: DNS_PROVIDER=cloudflare (no CLOUDFLARE_API_TOKEN)
#    Error: DNS_PROVIDER=cloudflare requires CLOUDFLARE_API_TOKEN
#
# ❌ INVALID: EMAIL_PROVIDER=resend (no RESEND_API_KEY)
#    Error: EMAIL_PROVIDER=resend requires RESEND_API_KEY

# ========================================
# Temporal Connection
# ========================================
# Local development (kubectl port-forward)
TEMPORAL_ADDRESS=localhost:7233

# Production (Kubernetes service)
# TEMPORAL_ADDRESS=temporal-frontend.temporal.svc.cluster.local:7233

TEMPORAL_NAMESPACE=default
TEMPORAL_TASK_QUEUE=bootstrap

# ========================================
# Supabase Configuration
# ========================================
SUPABASE_URL=https://cuvxypuwvbchsngjzdqo.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# ========================================
# Provider Credentials
# ========================================
# Required when:
# - WORKFLOW_MODE=production, OR
# - DNS_PROVIDER=cloudflare, OR
# - EMAIL_PROVIDER=resend/smtp

# Cloudflare DNS (required for DNS_PROVIDER=cloudflare)
CLOUDFLARE_API_TOKEN=your-cloudflare-api-token
# CLOUDFLARE_ZONE_ID=optional-zone-id

# Resend Email (required for EMAIL_PROVIDER=resend)
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# SMTP Email (required for EMAIL_PROVIDER=smtp)
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=your-smtp-username
# SMTP_PASS=your-smtp-password

# ========================================
# Development Features
# ========================================
# Add 'development' tag to all created entities
# Enables cleanup script to find and delete test data
TAG_DEV_ENTITIES=true

# Automatically run cleanup after workflow completes (development only)
# Removes DNS records and marks organizations as deleted
AUTO_CLEANUP=false

# ========================================
# Node.js Environment
# ========================================
# Used by Node.js tools (logger, etc.)
# Should match WORKFLOW_MODE:
#   - mock/development → NODE_ENV=development
#   - production → NODE_ENV=production
NODE_ENV=development

# Logging verbosity
LOG_LEVEL=info

# ========================================
# Quick Reference: Common Configurations
# ========================================
#
# 1. LOCAL DEVELOPMENT (default)
#    WORKFLOW_MODE=development
#    → Console logs only, no real resources created
#
# 2. TEST DNS ONLY
#    WORKFLOW_MODE=development
#    DNS_PROVIDER=cloudflare
#    CLOUDFLARE_API_TOKEN=your-token
#    → Creates real DNS, logs emails to console
#
# 3. TEST EMAIL ONLY
#    WORKFLOW_MODE=development
#    EMAIL_PROVIDER=resend
#    RESEND_API_KEY=your-key
#    → Logs DNS to console, sends real emails
#
# 4. FULL INTEGRATION TEST
#    WORKFLOW_MODE=production
#    CLOUDFLARE_API_TOKEN=your-token
#    RESEND_API_KEY=your-key
#    → Creates real DNS and sends real emails
#
# 5. UNIT TESTS / CI
#    WORKFLOW_MODE=mock
#    → In-memory mocks, no output, fast execution
#
# ========================================
# Need Help?
# ========================================
# Documentation: workflows/README.md
# Configuration validation runs on worker startup
# Invalid configurations will show clear error messages
